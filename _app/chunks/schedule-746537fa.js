import{p as h}from"./periods-3c9faf13.js";import{f as w}from"./utils-1595b72e.js";function p(r,a){for(const n of r)n._event=a.spec.events.find(d=>d.id===n.event);return r}function E(r,a){const n=new Date("2022-06-04T13:25");let d=r.spec.schedule.filter(s=>new Date(s.period.end).getTime()>n.getTime());const T=r.spec.stages;for(const s of T.filter(o=>o.livestream)){let o=d.filter(i=>i.stage===s.id),e=[...o],t=null;e.length>0&&new Date(e[0].period.start).getTime()<=n.getTime()&&(t=e[0],e=e.slice(1));let f="break";const m=s.streams.map(i=>h(r,i)),l=m.filter(i=>i.period.end.getTime()>=n.getTime());l.length===0&&l.push(m[m.length-1]);let c=null;if(t){let i=(new Date(t.period.end).getTime()-new Date(t.period.start).getTime())/1e3;c=Math.floor((n.getTime()-new Date(t.period.start).getTime())/1e3)/(i/100)}!t&&e[0]&&o[0].id===e[0].id&&(f="beforeStart"),!t&&e.length===0&&(f="afterEnd");const u=w(new Date(l[0].period.start),"yyyy-MM-dd");let g=0;u==="2022-06-05"&&(g=2);const v=`/program?time=${g}&stage=${s.id}&desc=true`;a[s.id]={current:t?p([t],r)[0]:null,currentPercentage:c,next:p(e.slice(0,2),r),stream:l[0],scheduleLink:v,breakType:f}}return a}export{E as g};
